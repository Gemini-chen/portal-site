{"version":3,"file":"index.js","sources":["../src/route/RouteMap.ts","../src/mapDataToRoute.ts","../src/util.ts","../src/mapper.ts","../src/httpClient.ts","../src/cmsDataProvider.ts","../src/model/routesMap.ts"],"sourcesContent":["import { IRouteMap, IRoute, IRootRouteMap } from '@portal-site/types';\r\nexport class RouteMap implements IRouteMap {\r\n    public parent: IRoute;\r\n    public children: Array<IRoute>;\r\n    public name: string;\r\n    public route: string;\r\n    public description: string | undefined;\r\n    public url: string | undefined;\r\n    public id: string;\r\n    public isHome: boolean;\r\n    get path(): string {\r\n        return toPath(this);\r\n    }\r\n    constructor() {\r\n        this.parent = {} as IRoute;\r\n        this.route = '';\r\n        this.children = [];\r\n        this.name = '';\r\n        this.isHome = false;\r\n        this.id = '';\r\n    }\r\n}\r\n\r\nfunction toPath(route: IRoute): string {\r\n    if (route.parent) {\r\n        return toPath(route.parent) + '/' + route.route;\r\n    }\r\n    return route.route || '';\r\n}\r\n\r\nconst _flatResultCache: IRoute[] = [];\r\nfunction _flatRoutes(root: any) {\r\n    const children = root.children;\r\n    if (children.length > 0) {\r\n        return children.map((i: any) => _flatRoutes(i));\r\n    }\r\n    !root.isRoot && _flatResultCache.push(root);\r\n}\r\n\r\nexport class RootRouteMap implements IRootRouteMap {\r\n    isRoot: true;\r\n    parent: null;\r\n    children: IRoute[];\r\n\r\n    constructor() {\r\n        this.isRoot = true;\r\n        this.parent = null;\r\n        this.children = [];\r\n    }\r\n    flat(): Array<IRoute> {\r\n        if (_flatResultCache.length > 0) return _flatResultCache;\r\n        _flatRoutes(this);\r\n        return _flatResultCache;\r\n    }\r\n    findByPath(path: string): IRoute | undefined {\r\n        return this.flat().find((route) => route.path === path);\r\n    }\r\n}\r\n","import { IRoute } from '@portal-site/types';\r\nimport { RouteMap } from './route';\r\n\r\nexport default function mapDataToRoute(data: any, parent: any): IRoute {\r\n    const route = new RouteMap();\r\n    const children = data.subChannel\r\n        ? data.subChannel.map((i: any) => mapDataToRoute(i, route))\r\n        : [];\r\n    route.children = children;\r\n    route.name = data.channelName;\r\n    route.route = data.channelNo;\r\n    route.parent = parent;\r\n    route.isHome = data.channelNo === 'Home';\r\n    return route;\r\n}\r\n","export const getImgFromHtml = (content: string = ''): string => {\r\n    //   匹配图片\r\n    const imgReg = /<img.*?(?:>|\\/>)/gi;\r\n    //   匹配src\r\n    const srcReg = /src=['\"]?([^'\"]*)['\"]?/i;\r\n    const arr = content.match(imgReg);\r\n    if (arr === null || arr.length < 0) return '';\r\n    //   获取第一张图片的src\r\n    const src = arr[0].match(srcReg);\r\n    return src ? src[1] : '';\r\n};\r\n\r\nexport const html2text = (\r\n    content: string,\r\n    {\r\n        length\r\n    }: {\r\n        length: number;\r\n        wordBreak: boolean;\r\n    } = {\r\n        length: 100,\r\n        wordBreak: false\r\n    }\r\n): string => {\r\n    const s = content?.replace(/<[^>]+>|&[^>]+;/g, '').trim();\r\n    if (s === '' || s === undefined) return '';\r\n    return s.substr(0, length) + '...';\r\n};\r\n","import { getImgFromHtml, html2text } from './util';\r\nimport { ListItem } from '@portal-site/types';\r\nexport const listMapper = (source: any[]): ListItem[] => {\r\n    return source.map(\r\n        (item): ListItem => {\r\n            return {\r\n                $raw_data: item,\r\n                id: item.archivesId, // 文章id\r\n                channelNo: item.channelNo, // 栏目编号\r\n                channelName: item.channelName, // 栏目名称\r\n                title: item.title, // 标题\r\n                subTitle: item.subTitle, // 副标题\r\n                publishDate: item.publishDate.split(' ')[0],\r\n                parentChannelNo: item.parentChannelNo, // 父栏目\r\n                imgSrc: encodeURI(item.thumbImg ? item.thumbImg : getImgFromHtml(item.content)),\r\n                appImgSrc: encodeURI(item.thumbAppImg ?? ''), // app缩略图，默认为'' 字符串作为 URI 进行编码\r\n                content: item.content, // 详情\r\n                $content: html2text(item.content),\r\n                abstract: item.description, // 摘要内容\r\n                source: item.source ?? '', // 文章来源\r\n                linkUrl: item.linkUrl ?? '', // 自定义链接,\r\n                isShowTitle: item.isShowTitle, // 是否显示标题\r\n                visitCount: item.visitCount\r\n            };\r\n        }\r\n    );\r\n};\r\nexport function listOneMapper(source: any): ListItem {\r\n    return {\r\n        $raw_data: source,\r\n        id: source.archivesId, // 文章id\r\n        channelNo: source.channelNo, // 栏目编号\r\n        channelName: source.channelName, // 栏目名称\r\n        title: source.title, // 标题\r\n        subTitle: source.subTitle, // 副标题\r\n        publishDate: source.publishDate.split(' ')[0],\r\n        parentChannelNo: source.parentChannelNo, // 父栏目\r\n        imgSrc: encodeURI(source.thumbImg ? source.thumbImg : getImgFromHtml(source.content)),\r\n        appImgSrc: encodeURI(source.thumbAppImg ?? ''), // app缩略图，默认为'' 字符串作为 URI 进行编码\r\n        abstract: source.description, // 摘要内容\r\n        content: source.content, // 详情\r\n        source: source.source || '', // 文章来源\r\n        linkUrl: source.linkUrl || '', // 自定义链接,\r\n        isShowTitle: source.isShowTitle, // 是否显示标题\r\n        visitCount: source.visitCount\r\n    };\r\n}\r\n","import axios, { AxiosInstance } from 'axios';\r\nimport CryptoJS from 'crypto-js';\r\n\r\nexport function createHttpClient(\r\n    baseURL: string,\r\n    appId: string,\r\n    appKey: string\r\n): AxiosInstance {\r\n    const httpClient = axios.create({\r\n        baseURL,\r\n    });\r\n    httpClient.interceptors.request.use(authInterceptor(appKey, appId));\r\n    httpClient.interceptors.response.use(res => res, resErrorInterceptor);\r\n    return httpClient;\r\n}\r\n\r\nexport function encryptApiKey(key: string): string {\r\n    const r = Math.random() + '';\r\n    const randomSix = r.substr(-6, 6);\r\n    const text = randomSix + +new Date();\r\n    const encrypt = CryptoJS.AES.encrypt(text, CryptoJS.enc.Utf8.parse(key), {\r\n        mode: CryptoJS.mode.ECB,\r\n        padding: CryptoJS.pad.Pkcs7,\r\n    });\r\n    return encrypt.toString();\r\n}\r\n\r\nfunction authInterceptor(key: string, id: string) {\r\n    return (req: any) => {\r\n        req.headers.token = encryptApiKey(key);\r\n        req.headers.appId = id;\r\n        return req;\r\n    };\r\n}\r\n\r\nfunction resErrorInterceptor(err: Error) {\r\n    console.group('🚨🚨httpError');\r\n    console.log('message:', err.message);\r\n    console.log('stack', err.stack);\r\n    console.groupEnd();\r\n    Promise.reject(err);\r\n    return err;\r\n}\r\n","import mapDataToRoute from './mapDataToRoute';\nimport { listMapper, listOneMapper } from './mapper';\nimport { CmsDataProvider, IHTTPClient } from '@portal-site/types';\nimport { RootRouteMap } from './route/index';\nexport * from './httpClient';\nexport default (httpClient: IHTTPClient, gateway: string = 'sw-cms'): CmsDataProvider => {\n  return {\n    queryRoutes(resource: string | undefined): Promise<any> {\n      const endPoint = `/${gateway}/api/queryAllChannel/${resource}`;\n\n      return new Promise((resolve, reject) => {\n        httpClient\n          .get(endPoint)\n          .then((res: any) => {\n            const root = new RootRouteMap();\n            const routeMaps = res.data.data.records.map((r: any) => {\n              return mapDataToRoute(r, root);\n            });\n            root.children = routeMaps;\n            resolve(root);\n          })\n          .catch((err: Error) => reject(err));\n      });\n    },\n    queryList({ resource, page, size }: { resource: string; page: number; size: number }) {\n      const endPoint = `/${gateway}/api/queryArchivesList`;\n      return new Promise((resolve, reject) => {\n        httpClient\n          .post(endPoint, {\n            entity: {\n              channelNo: resource\n            },\n            param: {\n              pageSize: size,\n              pageNum: page\n            }\n          })\n          .then((res: any) => {\n            resolve({\n              records: listMapper(res.data.data.records),\n              pages: res.data.data.pages,\n              page: res.data.data.current,\n              total: res.data.data.total,\n              $$rawData: res.data.data\n            });\n          })\n          .catch((err: any) => {\n            reject(err);\n          });\n      });\n    },\n    queryOneById(resource: string, path = 'queryArchivesById') {\n      return new Promise((resolve, reject) => {\n        return httpClient\n          .get(`/${gateway}/api/${path}/${resource}`)\n          .then((res: any) => {\n            resolve({\n              data: listOneMapper(res.data.data)\n              // $$rawData: res.data.data\n            });\n          })\n          .catch((err: any) => {\n            reject(err);\n          });\n      });\n    },\n    likeIt(resource: string) {\n      return new Promise((resolve, reject) => {\n        return httpClient\n          .get(`/${gateway}/api/doStarByArcId/${resource}`)\n          .then((res: any) => {\n            resolve({\n              code: res.data.code\n            });\n          })\n          .catch((err: any) => {\n            reject(err);\n          });\n      });\n    },\n    unLikeIt(resource: string) {\n      return new Promise((resolve, reject) => {\n        return httpClient\n          .get(`/${gateway}/api/cancelStarByActId/${resource}`)\n          .then((res: any) => {\n            resolve({\n              code: res.data.code\n            });\n          })\n          .catch((err: any) => {\n            reject(err);\n          });\n      });\n    }\n  };\n};\n","import { RootRouteMap } from '../route/index';\r\nimport { CmsDataProvider, IRootRouteMap } from '@portal-site/types';\r\nimport { put, call, takeLatest } from 'redux-saga/effects';\r\n\r\nexport interface routesMapState {\r\n    loading: boolean;\r\n    root: IRootRouteMap;\r\n    error: any;\r\n}\r\n\r\nconst routeMaps = (\r\n    dataProvider: CmsDataProvider\r\n): {\r\n    state: routesMapState;\r\n    namespace: string;\r\n    reducer: object;\r\n    effect: Function;\r\n} => ({\r\n    namespace: 'routesMap',\r\n    state: {\r\n        loading: true,\r\n        root: new RootRouteMap(),\r\n        error: null\r\n    },\r\n    reducer: {\r\n        getRoutes(state: routesMapState) {\r\n            return state;\r\n        },\r\n        getRoutesSuccess(_: routesMapState, { payload }: { payload: IRootRouteMap }) {\r\n            return {\r\n                loading: false,\r\n                root: payload\r\n            };\r\n        },\r\n        getRoutesFailure(state: routesMapState, { meta }: { meta: any }) {\r\n            return {\r\n                loading: false,\r\n                error: meta.error,\r\n                root: state.root\r\n            };\r\n        }\r\n    },\r\n    effect(actions: any) {\r\n        function* worker(action: any) {\r\n            try {\r\n                const records = yield call([dataProvider, 'queryRoutes'], action.payload);\r\n                yield put(actions.getRoutesSuccess(records));\r\n            } catch (error) {\r\n                yield put(actions.getRoutesFailure(null, null, error));\r\n            }\r\n        }\r\n        return function* () {\r\n            yield takeLatest(actions.getRoutes, worker);\r\n        };\r\n    }\r\n});\r\n\r\nexport default routeMaps;\r\n"],"names":["RouteMap","parent","route","children","name","isHome","id","toPath","_flatResultCache","_flatRoutes","root","length","map","i","isRoot","push","RootRouteMap","flat","findByPath","path","find","mapDataToRoute","data","subChannel","channelName","channelNo","getImgFromHtml","content","imgReg","srcReg","arr","match","src","html2text","wordBreak","s","replace","trim","undefined","substr","listMapper","source","item","$raw_data","archivesId","title","subTitle","publishDate","split","parentChannelNo","imgSrc","encodeURI","thumbImg","appImgSrc","thumbAppImg","$content","abstract","description","linkUrl","isShowTitle","visitCount","listOneMapper","createHttpClient","baseURL","appId","appKey","httpClient","axios","create","interceptors","request","use","authInterceptor","response","res","resErrorInterceptor","encryptApiKey","key","r","Math","random","randomSix","text","Date","encrypt","CryptoJS","AES","enc","Utf8","parse","mode","ECB","padding","pad","Pkcs7","toString","req","headers","token","err","console","group","log","message","stack","groupEnd","Promise","reject","gateway","queryRoutes","resource","endPoint","resolve","get","then","routeMaps","records","catch","queryList","page","size","post","entity","param","pageSize","pageNum","pages","current","total","$$rawData","queryOneById","likeIt","code","unLikeIt","dataProvider","namespace","state","loading","error","reducer","getRoutes","getRoutesSuccess","_","payload","getRoutesFailure","meta","effect","actions","worker","action","call","put","takeLatest"],"mappings":"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"}