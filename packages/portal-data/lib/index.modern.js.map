{"version":3,"file":"index.modern.js","sources":["../src/route/RouteMap.ts","../src/mapDataToRoute.ts","../src/util.ts","../src/mapper.ts","../src/httpClient.ts","../src/cmsDataProvider.ts","../src/model/routesMap.ts"],"sourcesContent":["import { IRouteMap, IRoute, IRootRouteMap } from '@portal-site/types';\nexport class RouteMap implements IRouteMap {\n    public parent: IRoute;\n    public children: Array<IRoute>;\n    public name: string;\n    public route: string;\n    public description: string | undefined;\n    public url: string | undefined;\n    public id: string;\n    public isHome: boolean;\n    get path(): string {\n        return toPath(this);\n    }\n    constructor() {\n        this.parent = {} as IRoute;\n        this.route = '';\n        this.children = [];\n        this.name = '';\n        this.isHome = false;\n        this.id = '';\n    }\n}\n\nfunction toPath(route: IRoute): string {\n    if (route.parent) {\n        return toPath(route.parent) + '/' + route.route;\n    }\n    return route.route || '';\n}\n\nconst _flatResultCache: IRoute[] = [];\nfunction _flatRoutes(root: any) {\n    const children = root.children;\n    if (children.length > 0) {\n        return children.map((i: any) => _flatRoutes(i));\n    }\n    !root.isRoot && _flatResultCache.push(root);\n}\n\nexport class RootRouteMap implements IRootRouteMap {\n    isRoot: true;\n    parent: null;\n    children: IRoute[];\n\n    constructor() {\n        this.isRoot = true;\n        this.parent = null;\n        this.children = [];\n    }\n    flat(): Array<IRoute> {\n        if (_flatResultCache.length > 0) return _flatResultCache;\n        _flatRoutes(this);\n        return _flatResultCache;\n    }\n    findByPath(path: string): IRoute | undefined {\n        return this.flat().find((route) => route.path === path);\n    }\n}\n","import { IRoute } from '@portal-site/types';\r\nimport { RouteMap } from './route';\r\n\r\nexport default function mapDataToRoute(data: any, parent: any): IRoute {\r\n    const route = new RouteMap();\r\n    const children = data.subChannel\r\n        ? data.subChannel.map((i: any) => mapDataToRoute(i, route))\r\n        : [];\r\n    route.children = children;\r\n    route.name = data.channelName;\r\n    route.route = data.channelNo;\r\n    route.parent = parent;\r\n    route.isHome = data.channelNo === 'Home';\r\n    return route;\r\n}\r\n","export const getImgFromHtml = (content: string = ''): string => {\n    //   匹配图片\n    const imgReg = /<img.*?(?:>|\\/>)/gi;\n    //   匹配src\n    const srcReg = /src=['\"]?([^'\"]*)['\"]?/i;\n    const arr = content.match(imgReg);\n    if (arr === null || arr.length < 0) return '';\n    //   获取第一张图片的src\n    const src = arr[0].match(srcReg);\n    return src ? src[1] : '';\n};\n\nexport const html2text = (\n    content: string,\n    {\n        length\n    }: {\n        length: number;\n        wordBreak: boolean;\n    } = {\n        length: 100,\n        wordBreak: false\n    }\n): string => {\n    const s = content?.replace(/<[^>]+>|&[^>]+;/g, '').trim();\n    if (s === '' || s === undefined) return '';\n    return s.substr(0, length) + '...';\n};\n","import { getImgFromHtml, html2text } from './util';\r\nimport { ListItem } from '@portal-site/types';\r\nexport const listMapper = (source: any[]): ListItem[] => {\r\n    return source.map(\r\n        (item): ListItem => {\r\n            return {\r\n                $raw_data: item,\r\n                id: item.archivesId, // 文章id\r\n                channelNo: item.channelNo, // 栏目编号\r\n                channelName: item.channelName, // 栏目名称\r\n                title: item.title, // 标题\r\n                subTitle: item.subTitle, // 副标题\r\n                publishDate: item.publishDate.split(' ')[0],\r\n                parentChannelNo: item.parentChannelNo, // 父栏目\r\n                imgSrc: encodeURI(item.thumbImg ? item.thumbImg : getImgFromHtml(item.content)),\r\n                appImgSrc: encodeURI(item.thumbAppImg ?? ''), // app缩略图，默认为'' 字符串作为 URI 进行编码\r\n                content: item.content, // 详情\r\n                $content: html2text(item.content),\r\n                abstract: item.description, // 摘要内容\r\n                source: item.source ?? '', // 文章来源\r\n                linkUrl: item.linkUrl ?? '', // 自定义链接,\r\n                isShowTitle: item.isShowTitle, // 是否显示标题\r\n                visitCount: item.visitCount\r\n            };\r\n        }\r\n    );\r\n};\r\nexport function listOneMapper(source: any): ListItem {\r\n    return {\r\n        $raw_data: source,\r\n        id: source.archivesId, // 文章id\r\n        channelNo: source.channelNo, // 栏目编号\r\n        channelName: source.channelName, // 栏目名称\r\n        title: source.title, // 标题\r\n        subTitle: source.subTitle, // 副标题\r\n        publishDate: source.publishDate.split(' ')[0],\r\n        parentChannelNo: source.parentChannelNo, // 父栏目\r\n        imgSrc: encodeURI(source.thumbImg ? source.thumbImg : getImgFromHtml(source.content)),\r\n        appImgSrc: encodeURI(source.thumbAppImg ?? ''), // app缩略图，默认为'' 字符串作为 URI 进行编码\r\n        abstract: source.description, // 摘要内容\r\n        content: source.content, // 详情\r\n        source: source.source || '', // 文章来源\r\n        linkUrl: source.linkUrl || '', // 自定义链接,\r\n        isShowTitle: source.isShowTitle, // 是否显示标题\r\n        visitCount: source.visitCount\r\n    };\r\n}\r\n","import axios, { AxiosInstance } from 'axios';\r\nimport CryptoJS from 'crypto-js';\r\n\r\nexport function createHttpClient(\r\n    baseURL: string,\r\n    appId: string,\r\n    appKey: string\r\n): AxiosInstance {\r\n    const httpClient = axios.create({\r\n        baseURL,\r\n    });\r\n    httpClient.interceptors.request.use(authInterceptor(appKey, appId));\r\n    httpClient.interceptors.response.use(res => res, resErrorInterceptor);\r\n    return httpClient;\r\n}\r\n\r\nexport function encryptApiKey(key: string): string {\r\n    const r = Math.random() + '';\r\n    const randomSix = r.substr(-6, 6);\r\n    const text = randomSix + +new Date();\r\n    const encrypt = CryptoJS.AES.encrypt(text, CryptoJS.enc.Utf8.parse(key), {\r\n        mode: CryptoJS.mode.ECB,\r\n        padding: CryptoJS.pad.Pkcs7,\r\n    });\r\n    return encrypt.toString();\r\n}\r\n\r\nfunction authInterceptor(key: string, id: string) {\r\n    return (req: any) => {\r\n        req.headers.token = encryptApiKey(key);\r\n        req.headers.appId = id;\r\n        return req;\r\n    };\r\n}\r\n\r\nfunction resErrorInterceptor(err: Error) {\r\n    console.group('🚨🚨httpError');\r\n    console.log('message:', err.message);\r\n    console.log('stack', err.stack);\r\n    console.groupEnd();\r\n    Promise.reject(err);\r\n    return err;\r\n}\r\n","import mapDataToRoute from './mapDataToRoute';\r\nimport { listMapper, listOneMapper } from './mapper';\r\nimport { CmsDataProvider, IHTTPClient } from '@portal-site/types';\r\nimport { RootRouteMap } from './route/index';\r\nexport * from './httpClient';\r\nexport default (httpClient: IHTTPClient, gateway: string = 'sw'): CmsDataProvider => {\r\n    return {\r\n        queryRoutes(resource: string | undefined): Promise<any> {\r\n            const endPoint = `/${gateway}-cms/api/queryAllChannel/${resource}`;\r\n\r\n            return new Promise((resolve, reject) => {\r\n                httpClient\r\n                    .get(endPoint)\r\n                    .then((res: any) => {\r\n                        const root = new RootRouteMap();\r\n                        const routeMaps = res.data.data.records.map((r: any) => {\r\n                            return mapDataToRoute(r, root);\r\n                        });\r\n                        root.children = routeMaps;\r\n                        resolve(root);\r\n                    })\r\n                    .catch((err: Error) => reject(err));\r\n            });\r\n        },\r\n        queryList({ resource, page, size }: { resource: string; page: number; size: number }) {\r\n            const endPoint = `/${gateway}-cms/api/queryArchivesList`;\r\n            return new Promise((resolve, reject) => {\r\n                httpClient\r\n                    .post(endPoint, {\r\n                        entity: {\r\n                            channelNo: resource\r\n                        },\r\n                        param: {\r\n                            pageSize: size,\r\n                            pageNum: page\r\n                        }\r\n                    })\r\n                    .then((res: any) => {\r\n                        resolve({\r\n                            records: listMapper(res.data.data.records),\r\n                            pages: res.data.data.pages,\r\n                            page: res.data.data.current,\r\n                            total: res.data.data.total,\r\n                            $$rawData: res.data.data\r\n                        });\r\n                    })\r\n                    .catch((err: any) => {\r\n                        reject(err);\r\n                    });\r\n            });\r\n        },\r\n        queryOneById(resource: string, path = 'queryArchivesById') {\r\n            return new Promise((resolve, reject) => {\r\n                return httpClient\r\n                    .get(`/${gateway}-cms/api/${path}/${resource}`)\r\n                    .then((res: any) => {\r\n                        resolve({\r\n                            data: listOneMapper(res.data.data)\r\n                            // $$rawData: res.data.data\r\n                        });\r\n                    })\r\n                    .catch((err: any) => {\r\n                        reject(err);\r\n                    });\r\n            });\r\n        },\r\n        likeIt(resource: string) {\r\n            return new Promise((resolve, reject) => {\r\n                return httpClient\r\n                    .get(`/${gateway}-cms/api/doStarByArcId/${resource}`)\r\n                    .then((res: any) => {\r\n                        resolve({\r\n                            code: res.data.code\r\n                        });\r\n                    })\r\n                    .catch((err: any) => {\r\n                        reject(err);\r\n                    });\r\n            });\r\n        },\r\n        unLikeIt(resource: string) {\r\n            return new Promise((resolve, reject) => {\r\n                return httpClient\r\n                    .get(`/${gateway}-cms/api/cancelStarByActId/${resource}`)\r\n                    .then((res: any) => {\r\n                        resolve({\r\n                            code: res.data.code\r\n                        });\r\n                    })\r\n                    .catch((err: any) => {\r\n                        reject(err);\r\n                    });\r\n            });\r\n        }\r\n    };\r\n};\r\n","import { RootRouteMap } from '../route/index';\nimport { CmsDataProvider, IRootRouteMap } from '@portal-site/types';\nimport { put, call, takeLatest } from 'redux-saga/effects';\n\nexport interface routesMapState {\n    loading: boolean;\n    root: IRootRouteMap;\n    error: any;\n}\n\nconst routeMaps = (\n    dataProvider: CmsDataProvider\n): {\n    state: routesMapState;\n    namespace: string;\n    reducer: object;\n    effect: Function;\n} => ({\n    namespace: 'routesMap',\n    state: {\n        loading: true,\n        root: new RootRouteMap(),\n        error: null\n    },\n    reducer: {\n        getRoutes(state: routesMapState) {\n            return state;\n        },\n        getRoutesSuccess(_: routesMapState, { payload }: { payload: IRootRouteMap }) {\n            return {\n                loading: false,\n                root: payload\n            };\n        },\n        getRoutesFailure(state: routesMapState, { meta }: { meta: any }) {\n            return {\n                loading: false,\n                error: meta.error,\n                root: state.root\n            };\n        }\n    },\n    effect(actions: any) {\n        function* worker(action: any) {\n            try {\n                const records = yield call([dataProvider, 'queryRoutes'], action.payload);\n                yield put(actions.getRoutesSuccess(records));\n            } catch (error) {\n                yield put(actions.getRoutesFailure(null, null, error));\n            }\n        }\n        return function* () {\n            yield takeLatest(actions.getRoutes, worker);\n        };\n    }\n});\n\nexport default routeMaps;\n"],"names":["RouteMap","parent","route","children","name","isHome","id","toPath","_flatResultCache","_flatRoutes","root","length","map","i","isRoot","push","RootRouteMap","flat","findByPath","path","find","mapDataToRoute","data","subChannel","channelName","channelNo","getImgFromHtml","content","imgReg","srcReg","arr","match","src","html2text","wordBreak","s","replace","trim","undefined","substr","listMapper","source","item","$raw_data","archivesId","title","subTitle","publishDate","split","parentChannelNo","imgSrc","encodeURI","thumbImg","appImgSrc","thumbAppImg","$content","description","linkUrl","isShowTitle","visitCount","listOneMapper","createHttpClient","baseURL","appId","appKey","httpClient","axios","create","interceptors","request","use","authInterceptor","response","res","resErrorInterceptor","encryptApiKey","key","r","Math","random","randomSix","text","Date","encrypt","CryptoJS","AES","enc","Utf8","parse","mode","ECB","padding","pad","Pkcs7","toString","req","headers","token","err","console","group","log","message","stack","groupEnd","Promise","reject","gateway","queryRoutes","resource","endPoint","resolve","get","then","routeMaps","records","queryList","page","size","post","entity","param","pageSize","pageNum","pages","current","total","$$rawData","queryOneById","likeIt","code","unLikeIt","dataProvider","namespace","state","loading","error","reducer","getRoutes","getRoutesSuccess","_","payload","getRoutesFailure","meta","effect","actions","worker","action","call","put","takeLatest"],"mappings":"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"}